<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Impact Atlas - Conflict Tracker</title>
  
  <!-- CSS -->
  <link rel="stylesheet" href="assets/css/style.css">
  <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
  <link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster/dist/MarkerCluster.css" />
  <link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster/dist/MarkerCluster.Default.css" />
  <link rel="stylesheet" href="https://cdn.knightlab.com/libs/timeline3/latest/css/timeline.css" />
</head>
<body>

  <header>
    <div class="header-content">
      <h1>âš¡ Impact Atlas</h1>
      <nav>
        <a href="#map-section">Mappa</a>
        <a href="#timeline-section">Timeline</a>
        <a href="#about-section">Metodologia</a>
      </nav>
    </div>
  </header>

  <section class="hero">
    <div class="hero-content">
      <h2>Tracker Multi-Layer del Conflitto Ucraino</h2>
      <p>Monitoraggio in tempo reale di attacchi energetici, militari e civili. Basato su fonti OSINT verificate.</p>
      <button onclick="document.getElementById('map-section').scrollIntoView({behavior:'smooth'});">
        Esplora la mappa interattiva
      </button>
    </div>
  </section>

  <section id="map-section">
    <div class="map-container">
      
      <!-- Sidebar Filtri Avanzati -->
      <aside class="filters-sidebar">
        <h3>ğŸ¯ Filtri Avanzati</h3>
        
        <!-- Filtri Data -->
        <div class="filter-group">
          <label>ğŸ“… Data inizio</label>
          <input type="date" id="startDate">
        </div>
        
        <div class="filter-group">
          <label>ğŸ“… Data fine</label>
          <input type="date" id="endDate">
        </div>
        
        <!-- Filtro Categoria -->
        <div class="filter-group">
          <label>ğŸ“‚ Categoria</label>
          <select id="categoryFilter">
            <option value="">Tutte le categorie</option>
            <option value="ukraine-strike-energy">ğŸ‡ºğŸ‡¦ Attacchi UA â†’ Energia RU</option>
            <option value="ukraine-strike-military">ğŸ‡ºğŸ‡¦ Attacchi UA â†’ Militare RU</option>
            <option value="russia-strike-energy">ğŸ‡·ğŸ‡º Attacchi RU â†’ Energia UA</option>
            <option value="russia-strike-civilian">ğŸ‡·ğŸ‡º Attacchi RU â†’ Civili UA</option>
            <option value="cross-border">âš¡ Transfrontalieri</option>
          </select>
        </div>
        
        <!-- Filtro Attore -->
        <div class="filter-group">
          <label>ğŸ­ Attore</label>
          <select id="actorFilter">
            <option value="">Tutti</option>
            <option value="Ukraine">ğŸ‡ºğŸ‡¦ Ucraina</option>
            <option value="Russia">ğŸ‡·ğŸ‡º Russia</option>
          </select>
        </div>
        
        <!-- Filtro Impatto -->
        <div class="filter-group">
          <label>ğŸ’¥ Livello Impatto</label>
          <select id="impactFilter">
            <option value="">Tutti i livelli</option>
            <option value="critical">ğŸ”´ Critico</option>
            <option value="high">ğŸŸ  Alto</option>
            <option value="medium">ğŸŸ¡ Medio</option>
            <option value="low">ğŸŸ¢ Basso</option>
          </select>
        </div>
        
        <button id="applyFilter" class="btn-primary">Applica filtri</button>
        <button id="resetFilter" class="btn-secondary">Reset</button>
        
        <!-- Layer Controls -->
        <div class="layer-controls" style="margin-top: 1.5rem; padding-top: 1.5rem; border-top: 2px solid #dee2e6;">
          <h4 style="font-size: 1rem; margin-bottom: 1rem;">ğŸ—ºï¸ Controlli Layer</h4>
          
          <label class="layer-checkbox">
            <input type="checkbox" id="layerEventi" onchange="toggleEventsLayer(this.checked)" checked>
            <span style="background: #45a29e;"></span>
            Eventi
          </label>
          
          <label class="layer-checkbox">
            <input type="checkbox" id="layerHeatmap" onchange="toggleHeatmapLayer(this.checked)">
            <span style="background: #dc3545;"></span>
            Heatmap
          </label>
          
          <label class="layer-checkbox">
            <input type="checkbox" id="layerConfini" onchange="toggleBordersLayer(this.checked)">
            <span style="background: #6c757d;"></span>
            Confini
          </label>
          
          <label class="layer-checkbox">
            <input type="checkbox" id="layerSatellitare" onchange="toggleSatelliteLayer(this.checked)">
            <span style="background: #1f2833;"></span>
            Satellitare
          </label>
        </div>
        
        <!-- Legenda Heatmap -->
        <div class="heatmap-legend" style="margin-top: 1.5rem; padding-top: 1.5rem; border-top: 2px solid #dee2e6;">
          <h4 style="font-size: 0.95rem; margin-bottom: 1rem; color: #0b0c10;">ğŸ”¥ Legenda Heatmap</h4>
          <div style="background: linear-gradient(to right, #6c757d, #ffc107, #fd7e14, #dc3545); height: 12px; border-radius: 6px; margin-bottom: 8px;"></div>
          <div style="display: flex; justify-content: space-between; font-size: 0.75rem; color: #666;">
            <span>Basso</span>
            <span>Medio</span>
            <span>Alto</span>
            <span>Critico</span>
          </div>
        </div>
        
        <!-- Statistiche -->
        <div class="stats">
          <h4>ğŸ“Š Statistiche</h4>
          <p><strong>Eventi visualizzati:</strong> <span id="eventCount">0</span></p>
          <p><strong>Ultimo aggiornamento:</strong> <span id="lastUpdate">-</span></p>
          
          <div id="categoryStats" style="margin-top: 1rem;"></div>
        </div>
        
        <!-- Strumenti -->
        <div style="margin-top: 1.5rem; padding-top: 1.5rem; border-top: 2px solid #dee2e6;">
          <h4 style="font-size: 1rem; margin-bottom: 0.8rem;">ğŸ› ï¸ Strumenti</h4>
          <button id="exportData" class="btn-secondary" style="font-size: 0.85em; padding: 0.5rem;">
            ğŸ“¥ Esporta CSV
          </button>
        </div>
      </aside>
      
      <!-- Mappa -->
      <div class="map-wrapper">
        <div id="map"></div>
      </div>
      
      <!-- Sezione Grafici Timeline -->
      <div class="charts-section">
        <h3>ğŸ“Š Analisi Temporale</h3>
        
        <!-- Timeline Controls -->
        <div class="timeline-controls">
          <div class="timeline-filters">
            <div class="filter-item">
              <label>ğŸ“… Data inizio</label>
              <input type="date" id="chartStartDate">
            </div>
            
            <div class="filter-item">
              <label>ğŸ“… Data fine</label>
              <input type="date" id="chartEndDate">
            </div>
            
            <div class="filter-item">
              <label>ğŸ¯ Tipo evento</label>
              <select id="chartTypeFilter">
                <option value="">Tutti i tipi</option>
              </select>
            </div>
            
            <button id="resetChartFilters" class="btn-secondary-small">Reset filtri</button>
          </div>
        </div>
        
        <!-- Canvas per Chart.js -->
        <div class="chart-container">
          <canvas id="timelineChart"></canvas>
        </div>
      </div>
      
    </div>
  </section>

  <section id="timeline-section">
    <h2>ğŸ“… Timeline degli eventi</h2>
    <div id="timeline" style="width:100%; height:650px;"></div>
  </section>

  <section id="about-section">
    <div class="about-content">
      <h2>Metodologia e Fonti</h2>
      <div class="methodology-grid">
        <div class="method-card">
          <h3>ğŸ” Geolocalizzazione</h3>
          <p>Ogni evento Ã¨ verificato con coordinate GPS precise tramite analisi satellite e fonti multiple</p>
        </div>
        <div class="method-card">
          <h3>ğŸ“° Fonti OSINT</h3>
          <p>Reuters, Kyiv Independent, Euromaidan Press, Moscow Times, Bloomberg e altre fonti verificabili</p>
        </div>
        <div class="method-card">
          <h3>âœ“ Cross-check</h3>
          <p>Ogni informazione Ã¨ confermata da almeno due fonti indipendenti prima della pubblicazione</p>
        </div>
        <div class="method-card">
          <h3>ğŸ“Š Database Strutturato</h3>
          <p>Schema JSON modulare con metadata completi: attore, target, impatto, affidabilitÃ </p>
        </div>
        <div class="method-card">
          <h3>ğŸ¯ Categorizzazione</h3>
          <p>5 categorie principali: attacchi UA/RU su energia, militare, civili e transfrontalieri</p>
        </div>
        <div class="method-card">
          <h3>âš¡ Aggiornamento Real-time</h3>
          <p>Database aggiornato quotidianamente con nuovi eventi verificati</p>
        </div>
      </div>
    </div>
  </section>

  <footer>
    <p>&copy; 2025 Impact Atlas. Progetto OSINT indipendente. <a href="#">Disclaimer</a> | <a href="#">GitHub</a></p>
  </footer>

  <!-- Scripts -->
  <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
  <script src="https://unpkg.com/leaflet.markercluster/dist/leaflet.markercluster.js"></script>
  <script src="https://unpkg.com/leaflet.heat/dist/leaflet-heat.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
  <script src="https://cdn.knightlab.com/libs/timeline3/latest/js/timeline.js"></script>
  <script src="assets/js/map.js"></script>
  <script src="assets/js/charts.js"></script>

  <!-- Script Timeline con fix CSS -->
<script>
  var timeline = new TL.Timeline(
    "timeline",
    "https://lucagimbo12-star.github.io/osint-tracker/assets/data/events_timeline.json"
  );
  
  // Fix CSS dopo caricamento
  setTimeout(function() {
    var style = document.createElement('style');
    style.textContent = `
      #timeline .tl-text h2.tl-headline-title { font-size: 24px !important; line-height: 26px !important; }
      #timeline .tl-text h3 { font-size: 18px !important; line-height: 20px !important; }
      #timeline .tl-text p { font-size: 14px !important; line-height: 1.6 !important; }
      #timeline .tl-timemarker-text h2 { font-size: 11px !important; line-height: 12px !important; }
      #timeline .tl-timenav { height: 150px !important; }
      #timeline { height: 600px !important; }
    `;
    document.head.appendChild(style);
  }, 500);
</script>
  
</body>
</html>
